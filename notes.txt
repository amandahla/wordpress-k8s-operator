# Bootstrap a juju controller, or switch to one you want to use
juju bootstrap --no-gui localhost lxd \
    --config automatically-retry-hooks=false --config apt-http-proxy=http://10.0.4.1:3142/

# Install microk8s
sudo snap install microk8s

# Attach the microk8s cluster to Juju, which will show up as a cloud per juju list-clouds
# Note that microk8s.config massages the config in a necessary way
microk8s.config | juju add-k8s microk8s --cluster-name=microk8s-cluster
## kubectl config view --raw | juju add-k8s microk8s --cluster-name=microk8s-cluster

# Create a model on the newly created microk8s cloud
juju add-model modelname microk8s

# Build the charm
charm build -o $JUJU_REPOSITORY

# Deploy the charm
juju deploy $JUJU_REPOSITORY/builds/portal-caas
